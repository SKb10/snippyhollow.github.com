
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Adaptor Grammars - Exchangeable random experiments</title>
  <meta name="author" content="syhw">

  
  <meta name="description" content="Adaptor grammars are a quite recent nonparametric extension of PCFGs, which also can implement (discrete) hierarchial Dirichlet processes, with &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://snippyhollow.github.com/blog/2013/03/19/adaptor-grammars/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Exchangeable random experiments" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-38472185-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
            inlineMath: [ ['$', '$'] ],
            displayMath: [ ['$$', '$$']],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        },
        messageStyle: "none",
        "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Exchangeable random experiments</a></h1>
  
    <h2>blog += 1</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:snippyhollow.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about/">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Adaptor Grammars</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-19T10:25:00+01:00" pubdate data-updated="true">Mar 19<span>th</span>, 2013</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Adaptor grammars are a <a href="http://mailserver.cog.brown.edu/~mj/papers/JohnsonGriffithsGoldwater06AdaptorGrammars.pdf">quite recent</a> nonparametric extension of PCFGs, which also can implement (discrete) hierarchial Dirichlet processes, with several applications in NLP already.</p>

<h3 id="probabilistic-context-free-grammars">Probabilistic Context Free Grammars</h3>

<p>A <a href="https://en.wikipedia.org/wiki/Context-free_grammar"><em>CFG</em></a> is a quadruple $(N, W, R, S)$ with:</p>

<ul>
  <li>$N$ a set of nonterminal symbols, e.g. (for the grammar of English): NP (noun phrase), VP (verb phrase).</li>
  <li>$W$ a set of terminal symbols, e.g. “cat”, “dog”, “ate”.</li>
  <li>$R$ a set of rules $A \rightarrow \beta$, with $A \in N$ and $\beta \in (N \cup W)$, e.g. $S \rightarrow NP\ VP;$ $NP \rightarrow the\ NN;$ $NN \rightarrow cat\ |\ dog; \dots$</li>
  <li>$S$ the start symbol $S \in N$.</li>
</ul>

<p>A <a href="https://en.wikipedia.org/wiki/Stochastic_context-free_grammar"><em>PCFG</em></a> (sometimes also stochastic context-free grammar), is a quintuple $(N, W, R, S, \theta)$ which adds probabilities $\theta$ on all the rules: $\theta_{A \rightarrow \beta}$ is the probability that $A$ expands into $\beta$.</p>

<p>The set of all <script type="math/tex">\theta_{A \rightarrow b}</script> defines a distribution $G_A$ over trees that have $A$ as a root (noted $T_A$). That is, if when we are in $A$ we can generate subtrees <script type="math/tex">t_1 \dots t_n</script> with root $A$, the distribution on these subtrees is <script type="math/tex">\prod_{i=1}^n G_i(t_i)</script>: the $t_i$ are generated indepently (of <script type="math/tex">t_{j \neq i}</script>) from $G_i$. That is the assumption that is relaxed by adaptor grammars.</p>

<h3 id="pitman-yor-process">Pitman-Yor Process</h3>

<p>The Pitman-Yor (PY) process is a simple extension of the <a href="https://en.wikipedia.org/wiki/Chinese_restaurant_process">Chinese restaurant process (CRP)</a> (the CRP is equivalent to the Dirichlet process, that we used previously in the <a href="http://snippyhollow.github.com/blog/2013/03/10/collapsed-gibbs-sampling-for-dirichlet-process-gaussian-mixture-models/">DPGMM</a>). </p>

<p>Actually, similarly as the CRP maps to the Dirichlet process, the PY process maps to the Poisson-Dirichlet process. The CRP has only one concentration parameter $\alpha$ and creating new tables with probability $\frac{\alpha}{\alpha + N - 1}$. So for the CRP with $\delta_k$ the Kronecker delta function (Dirac distribution), $N$ datapoints, $M$ clusters, and $N_k$ datapoints in cluster $k$, we have:</p>

<script type="math/tex; mode=display">
z_{n+1} | z_1 \dots z_n \sim \frac{\alpha}{\alpha + N - 1}\delta_{M+1} + \sum_{k=1}^M \frac{N_{k}}{\alpha + N - 1}\delta_k
</script>

<p>The PY process has two parameters $a$ and $b$, $b$ playing the role of $\alpha$ (we get backt to the CRP is $a=0$), the probability of creating a new table is now $\frac{M.a + b}{N + b}$, so we have:</p>

<script type="math/tex; mode=display">
z_{n+1} | z_1 \dots z_n \sim \frac{M.a + b}{N + b} \delta_{M+1} + \sum_{k=1}^M \frac{N_{k} - a}{N + b}\delta_k
</script>

<h3 id="bayesian-nonparametrics-as-caching">Bayesian Nonparametrics as Caching</h3>

<p>Now we will make a small detour to pinpoint the parallel between Bayesian non-parametrics (I’m thinking about the CRP and the PY process) and “caching” (keeping frequently accessed items where they can be quickly accessed). Take for instance the problem of learning the grammar of English from a <a href="http://en.wikipedia.org/wiki/Treebank">Treebank</a> (POS-tags annotated tree) dataset.</p>

<p>The PCFG generative story to build a grammar: for all inputs, repeat:</p>

<ul>
  <li>Set <script type="math/tex">root(rule) = S</script>,</li>
  <li>Pick a rule according to $P(rule | root(rule))$ and expands it,</li>
  <li>Recursively pick rules (as above) and expand them until all leaves are terminal symbols (words).</li>
</ul>

<p>Notice that no context is used in the rule selection. </p>

<p>Sure we can do better by adding context for the rule selection, but how? A good idea is to limit context to rules that we used so far. To quote Kevin Knight: “clearly this story of re-use is pervasive in natural language. Ask anyone named Zipf.” </p>

<p>So let’s re-use the rules that we already used successfully. Here is the Bayesian nonparametrics tree substitution grammar (TSG) generative story, repeat:</p>

<ul>
  <li>Set <script type="math/tex">root(rule) = S</script>,</li>
  <li>Pick a rule according to $P(rule | root(rule), counts\ of\ rules\ used)$ and expands it,</li>
  <li>Recursively pick rules (as above) and expand them until all leaves are terminal symbols (words).</li>
</ul>

<p>How do we set-up $P(rule | root(rule), counts\ of\ rules\ used)$? We can simply mix between the rule probability and the rule uses history with a $\beta$ parameter:</p>

<script type="math/tex; mode=display">
P(rule | root(rule), rules\ use\ history) = \beta P_0(rule | root(rule)) \\
+ (1-\beta) \frac{count(rule)}{\sum_{r \in rules\ with\ same\ root\ as\ rule} count(r\in cache)}
</script>

<p>All the same for adaptor grammars: as a PCFG can only learn the probability to for the rewrite $VP \rightarrow VB PP$, an adaptor grammar can learn (“cache”) the probability for a specific production $VP \rightarrow (VB climb) (P up) (NP)$.</p>

<h3 id="adaptor-grammars">Adaptor Grammars</h3>

<p>An adaptor C is a function which transforms a distribution into another with the same support. An adaptor grammar is a sextuple $(N, W, R, S, \theta, C)$, where $(N, W, R, S, \theta)$ is a PCFG and C is a vector of adaptors (indexed by N). </p>

<p>For any rule $A \in N$, $C_A$ maps a distribution over trees $T_A$ to another distribution over the same trees.</p>

<h3 id="pitman-yor-adaptor-grammars">Pitman-Yor Adaptor Grammars</h3>

<h3 id="hierarchical-dirichlet-processes">Hierarchical Dirichlet Processes</h3>

<p>Stay tuned for algorithms and for an implementation description.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">syhw</span></span>

      








  


<time datetime="2013-03-19T10:25:00+01:00" pubdate data-updated="true">Mar 19<span>th</span>, 2013</time>
      


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://snippyhollow.github.com/blog/2013/03/19/adaptor-grammars/" data-via="syhw" data-counturl="http://snippyhollow.github.com/blog/2013/03/19/adaptor-grammars/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/03/10/collapsed-gibbs-sampling-for-dirichlet-process-gaussian-mixture-models/" title="Previous Post: Collapsed Gibbs Sampling for Dirichlet Process Gaussian Mixture Models">&laquo; Collapsed Gibbs Sampling for Dirichlet Process Gaussian Mixture Models</a>
      
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/03/19/adaptor-grammars/">Adaptor Grammars</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/03/10/collapsed-gibbs-sampling-for-dirichlet-process-gaussian-mixture-models/">Collapsed Gibbs Sampling for Dirichlet Process Gaussian Mixture Models</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/03/08/from-hacks-to-bayesian-probability/">From hacks to Bayesian probability</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/SnippyHolloW">@SnippyHolloW</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'SnippyHolloW',
            count: 4,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("syhw", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/syhw" class="twitter-follow-button" data-show-count="false">Follow @syhw</a>
  
</section>


<section>
  <h1>My Pinboard</h1>
  <ul id="pinboard_linkroll">Fetching linkroll...</ul>
  <p><a href="http://pinboard.in/u:syhw">My Pinboard Bookmarks &raquo;</a></p>
</section>
<script type="text/javascript">
  var linkroll = 'pinboard_linkroll'; //id target for pinboard list
  var pinboard_user = "syhw"; //id target for pinboard list
  var pinboard_count = 5; //id target for pinboard list
  (function(){
    var pinboardInit = document.createElement('script');
    pinboardInit.type = 'text/javascript';
    pinboardInit.async = true;
    pinboardInit.src = '/javascripts/pinboard.js';
    document.getElementsByTagName('head')[0].appendChild(pinboardInit);
  })();
</script>




  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - syhw -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
